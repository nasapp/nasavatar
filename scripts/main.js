"use strict";$(function(){var e,t=window.console||{log:function(){}},a=window.URL||window.webkitURL,o=$("#image"),r=($("#download"),$("#dataX")),p=$("#dataY"),c=$("#dataHeight"),i=$("#dataWidth"),n=$("#dataRotate"),d=$("#dataScaleX"),l=$("#dataScaleY"),s={aspectRatio:1,preview:".img-preview",crop:function(e){r.val(Math.round(e.detail.x)),p.val(Math.round(e.detail.y)),c.val(Math.round(e.detail.height)),i.val(Math.round(e.detail.width)),n.val(e.detail.rotate),d.val(e.detail.scaleX),l.val(e.detail.scaleY)}},v=(o.attr("src"),"cropped.jpg"),g="image/jpeg";o.on({ready:function(e){t.log(e.type)},cropstart:function(e){t.log(e.type,e.detail.action)},cropmove:function(e){t.log(e.type,e.detail.action)},cropend:function(e){t.log(e.type,e.detail.action)},crop:function(e){t.log(e.type)},zoom:function(e){t.log(e.type,e.detail.ratio)}}).cropper(s),$.isFunction(document.createElement("canvas").getContext)||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),void 0===document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),$(".docs-toggles").on("change","input",function(){var e,t,a=$(this),r=a.attr("name"),p=a.prop("type");o.data("cropper")&&("checkbox"===p?(s[r]=a.prop("checked"),e=o.cropper("getCropBoxData"),t=o.cropper("getCanvasData"),s.ready=function(){o.cropper("setCropBoxData",e),o.cropper("setCanvasData",t)}):"radio"===p&&(s[r]=a.val()),o.cropper("destroy").cropper(s))}),$(".docs-buttons").on("click","[data-method]",function(){var e,a,r,p=$(this),c=p.data(),i=o.data("cropper");if(!p.prop("disabled")&&!p.hasClass("disabled")&&i&&c.method){if(c=$.extend({},c),void 0!==c.target&&(a=$(c.target),void 0===c.option))try{c.option=JSON.parse(a.val())}catch(e){t.log(e.message)}switch(e=i.cropped,c.method){case"rotate":e&&s.viewMode>0&&o.cropper("clear");break;case"getCroppedCanvas":"image/jpeg"===g&&(c.option||(c.option={}),c.option.fillColor="#fff"),t.log(c)}switch(r=o.cropper(c.method,c.option,c.secondOption),c.method){case"rotate":e&&s.viewMode>0&&o.cropper("crop");break;case"scaleX":case"scaleY":$(this).data("option",-c.option);break;case"getCroppedCanvas":r&&(t.log(r.toDataURL(g)),onCallClick("save",r.toDataURL(g)))}if($.isPlainObject(r)&&a)try{a.val(JSON.stringify(r))}catch(e){t.log(e.message)}}}),$(document.body).on("keydown",function(e){if(o.data("cropper")&&!(this.scrollTop>300))switch(e.which){case 37:e.preventDefault(),o.cropper("move",-1,0);break;case 38:e.preventDefault(),o.cropper("move",0,-1);break;case 39:e.preventDefault(),o.cropper("move",1,0);break;case 40:e.preventDefault(),o.cropper("move",0,1)}});var h=$("#inputImage");a?h.change(function(){var t,r=this.files;o.data("cropper")&&r&&r.length&&(t=r[0],/^image\/\w+$/.test(t.type)?(v=t.name,g=t.type,e&&a.revokeObjectURL(e),e=a.createObjectURL(t),o.cropper("destroy").attr("src",e).cropper(s),h.val("")):window.alert("Please choose an image file."))}):h.prop("disabled",!0).parent().addClass("disabled")});